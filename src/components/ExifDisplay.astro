---
import type { PhotoExif } from '../utils/exif';
import { exifConfig, type ExifFieldKey } from '../config/exif';

interface Props {
  exif: PhotoExif;
  fields?: ExifFieldKey[];
}

const { exif, fields = exifConfig.defaultFields } = Astro.props;

const displayData = fields
  .map(field => ({
    label: exifConfig.availableFields[field],
    value: formatValue(field, exif[field as keyof PhotoExif])
  }))
  .filter(item => item.value);

function formatValue(field: ExifFieldKey, value: any): string | null {
  if (value === undefined || value === null) return null;

  if (field === 'fNumber') {
    return `f/${value}`;
  }
  if (field === 'focalLength') {
    return `${value}mm`;
  }
  if (field === 'dateTime' && value instanceof Date) {
    return value.toLocaleDateString();
  }

  return String(value);
}
---

{displayData.length > 0 && (
  <div class="text-xs text-gray-500 space-y-0.5">
    {displayData.map(({ label, value }) => (
      <div class="flex gap-2">
        <span class="text-gray-400">{label}:</span>
        <span>{value}</span>
      </div>
    ))}
  </div>
)}
